#include <LiquidCrystal.h>
#include <Encoder.h>

// ---------------- LCD ----------------
LiquidCrystal lcd(8, 9, 4, 5, 6, 7);

// ---------------- MOTOR PINS ----------------
const int ENA = A1, IN1 = 12, IN2 = 13;  // Left motor
const int ENB = 3,  IN3 = 2,  IN4 = 1;   // Right motor

// ---------------- LINE SENSORS ----------------
const int leftSensor  = A2;
const int rightSensor = A3;
int threshold = 400;

// ---------------- SPEED ----------------
int leftSpeed  = 180;
int rightSpeed = 235;

// ---------------- ENCODER ----------------
// Encoder on analog pins A4 & A5
Encoder wheelEnc(A4, A5);

// ---------------- DISTANCE ----------------
const float wheelDiameter = 6.6;        // cm, adjust for your wheels
const int encoderTicksPerRev = 20;       // adjust for your encoder
float wheelCircumference = wheelDiameter * PI;
float totalDistance = 0;
const float stopDistance = 400.0;        // 400 cm marker

long lastEncoderCount = 0;

// ---------------- TIMING ----------------
unsigned long startTime;
unsigned long endTime;

// ---------------- STATE FLAGS ----------------
bool pausedAt400cm = false;
bool finishedTrack   = false;

void setup() {
  pinMode(ENA, OUTPUT); pinMode(IN1, OUTPUT); pinMode(IN2, OUTPUT);
  pinMode(ENB, OUTPUT); pinMode(IN3, OUTPUT); pinMode(IN4, OUTPUT);

  pinMode(leftSensor, INPUT);
  pinMode(rightSensor, INPUT);

  lcd.begin(16, 2);
  lcd.print("Line Challenge");
  delay(1500);
  lcd.clear();

  startTime = millis();
}

// ---------------- MAIN LOOP ----------------
void loop() {
  if (finishedTrack) return;

  // ---------- READ ENCODER ----------
  long encoderCount = wheelEnc.read();
  l
